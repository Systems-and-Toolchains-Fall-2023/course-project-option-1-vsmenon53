[![Review Assignment Due Date](https://classroom.github.com/assets/deadline-readme-button-24ddc0f5d75046c5622901739e7c5dd533143b0c8e959d652212380cedb1ea36.svg)](https://classroom.github.com/a/nyeWPUMW)


**14-763: Systems and Tool Chains for AI Engineers**

**Course Project: Option 1**

**ReadMe File**

**Group Members:**
Nishanth Mohankumar, Vignesh Sujith Menon

**Project and Dataset Description**<br />

The dataset consists of meticulously organized statistics of soccer players, providing an in-depth perspective on player performance metrics, attributes, overall ratings, and other keyfeatures pertaining to the player. The dataset was originally collected and used for the popular FIFA games accross the years 2015 to 2022. A more detailed desciption of all features in the dataset are provided below. 
The objectives of the project includes building and populating necessary database tables, conducting analysis on the dataset, employing Machine Learning models to predict the statistic "overall" of each player, and finally to deploy the code on the cloud.

**Task 3: Explanation on the choice of regressor and hyperparameters**<br />
Firstly, we treat the prediction of "overall" as a regression task. We come to this conclusion because "overall" seems to be a continuous value from 40 - 94, rather than a discrete value, in which case this would be a classification problem. Not to say that this problem may not be implemented as a classification problem, however, we do believe that treating the problem as a regression problem is the most efficient and intuitive way of approaching this problem.<br /> 

**Spark: Linear Regression and XG Gradient Boosted Trees**<br />
The above regression models were chosen because of their difference in complexity and underlying structure of these models. A linear regression being the most basic form of regression, while  GBT being a more complicated non-linear regression technique. Parameters were tuned using a Parameter Grid which instantiated models with each set of specified parameters. The best model is saved and the prediction results using that best model are published. The grid and results from each model are given below. <br />

**Linear Regression**<br />
Parameter Grid: lr_paramGrid = (ParamGridBuilder()
             .addGrid(lr.regParam, [0, 0.01, 0.1, 1])
             .addGrid(lr.maxIter, [100, 500, 1000])
             .build())<br />
RMSE before tuning: 2.78<br />
default regPara = 0<br />
default maxIter = 100<br />

Root Mean Squared Error (RMSE) on test data after tuning = 2.77<br />
Regularization Parameter after tuning:  0.0<br />
Maximum Iteration Parameter after tuning:  100<br />

**GBT**<br />
Parameter Grid: gbt_paramGrid = (ParamGridBuilder()
             .addGrid(gbt.stepSize, [0.001, 0.01, 0.1, 0.5])
             .addGrid(gbt.maxDepth, [2, 5, 10])
             .build())<br />
RMSE before tuning: 1.92<br />
default stepSize = 0.1<br />
default maxDepth = 5<br />

Root Mean Squared Error (RMSE) on test data after tuning = 1.38<br />
Step Size/Learning Rate Parameter after tuning:  0.1<br />
Maximum Depth Parameter after tuning:  10<br />

**PyTorch: Shallow Neural Network and Deep Neural Network**<br /><br />
**PyTorch Shallow Neural Network Model Tuning: 2 hidden layers, each with a width of 8**<br />
Attempt 1. lr = 0.005, batch_size = 32, N_epochs = 50, optimizer = Adam<br />
Train and Validation Loss graphs look typical of a converging model. However, upon further inspection of the per epoch results, it seems that the train loss is still decreasing with every epoch. Therefore, we try to increase learning rate in hopes of the model converging earlier. But we will also increase the batch size to combat the accompanied randomness. <br />
Validation Loss = 1.79<br />

Attempt 2. lr = 0.01, batch_size = 64, N_epochs = 50, optimizer = Adam<br />
With this model, we achieve ideal model behaviour over the 50 epochs. Train loss seems to have converged by the 40th epoch. And the graph of train and validation seem ideal as well. Additionally, we also see an improvement of validation loss to 1.70. Therefore, we are satisfied with these training parameters.<br />

**Best Model: Train Loss = 1.89, Validation Loss = 1.70, Test Loss = 1.30**<br />

**PyTorch Deep Neural Network Model Tuning: 6 hidden layers with width as follows: 16, 32, 64, 64, 32, and 16**<br />
Attempt 1. lr = 0.005, batch_size = 32, N_epochs = 50, optimizer = Adam<br />
We observe very good performance on both the training and validation set. However, it does seem like even at the 50th epoch, the loss values are decreasing. Therefore, we may come to the conclusion that the loss value hasn't converged yet, even though the validation loss is extremely low at 0.75. So we will try to help the model converge faster by increasing the learning rate and batch size(to combat the accompanied increase in randomness/oscillation in loss). Another reason for increasing the batch size is that the training of the model took quite long(30 minutes), which may be because the batch size is so small that each epoch has so many batches that it iterates through, making it take too long.<br />
Validation Loss = 0.752<br />

Attempt 2. lr = 0.01, batch_size = 64, N_epochs = 50, optimizer = Adam<br />
With these training parameters, the model does achieve better validation accuracy of 0.717. However, a look at the loss curves show an oscillating pattern which doesn't bode well. Additionally we also see spikes in the train batch loss plot, pointing toward the learning rate being too high. This is undesirable and therefore, we will further tune the model by decreasing learning rate to 0.005 and increasing the N_epochs to 100, so we overcome the problem faced in the 1st iteration. We are happy with the result of the model, but would like the model to perform better in terms of training. <br />
Validation Loss = 0.717<br />

Attempt 3. lr = 0.005, batch_size = 64, N_epochs = 100, optimizer = Adam<br />
We still do continue to see randomness/oscillations in the validation and train loss, even though it is not so pronounced. However, the validation loss achieved from this model is higher than from the 2nd set of training parameters. And since this difference is considerable, with reference to the actual loss value, it would make more sense to run the model with the 2nd set of parameters, since we are anyways only saving the loss value of the best model. <br />
Validation Loss = 0.823<br />

**Best Model: Train Loss = 0.935, Validation Loss = 0.753, Test Loss = 0.86**<br /><br /><br />


**Feature Description**

- sofifa\_id: Identifier for each player in Sofifa database.
- player\_url: URL link to the player's profile.
- short\_name: Shortened version of the player's name.
- long\_name: Full name of the player.
- player\_positions: Positions at which the player can play.
- overall: Overall rating of the player's skills and abilities.
- potential: The potential overall rating a player can achieve.
- value\_eur: Current market value of the player in Euros.
- wage\_eur: Weekly wage of the player in Euros.
- age: Age of the player.
- dob: Date of birth of the player.
- height\_cm: Height of the player in centimeters.
- weight\_kg: Weight of the player in kilograms.
- club\_team\_id: Unique identifier for the player's club team.
- club\_name: Name of the player's club team.
- league\_name: Name of the league in which the club team participates.
- league\_level: Level of the league (e.g., top-tier, second-tier).
- club\_position: Position at which the player plays in the club team.
- club\_jersey\_number: Jersey number worn by the player in the club team.
- club\_loaned\_from: Club from which the player is loaned (if applicable).
- club\_joined: Date when the player joined the current club team.
- club\_contract\_valid\_until: Expiry date of the player's contract with the club team.
- nationality\_id: Unique identifier for the player's nationality.
- nationality\_name: Nationality of the player.
- nation\_team\_id: Unique identifier for the player's national team.
- nation\_position: Position at which the player plays in the national team.
- nation\_jersey\_number: Jersey number worn by the player in the national team.
- preferred\_foot: Player's preferred foot (left or right).
- weak\_foot: Rating of the player's weaker foot (out of 5).
- skill\_moves: Rating of the player's skill moves (out of 5).
- international\_reputation: Rating of the player's international reputation (out of 5).
- work\_rate: Player's work rate; Offense/Defense (e.g., High/High, Medium/Low).
- body\_type: Physique/body type of the player.
- real\_face: Whether the player has a real face in the game (Yes/No).
- release\_clause\_eur: Release clause value in Euros.
- player\_tags: Tags associated with the player’s play style.
- player\_traits: Strength associated with the player.
- pace, shooting, passing, dribbling, defending, physic: Various skill ratings related to the player's abilities.
- attacking\_crossing, attacking\_finishing, attacking\_heading\_accuracy, attacking\_short\_passing, attacking\_volleys, skill\_dribbling, skill\_curve, skill\_fk\_accuracy, skill\_long\_passing, skill\_ball\_control: More detailed skill ratings related to specific player abilities.
- movement\_acceleration, movement\_sprint\_speed, movement\_agility, movement\_reactions, movement\_balance: Ratings related to player movement abilities.
- power\_shot\_power, power\_jumping, power\_stamina, power\_strength, power\_long\_shots: Ratings related to player power attributes.
- mentality\_aggression, mentality\_interceptions, mentality\_positioning, mentality\_vision, mentality\_penalties, mentality\_composure: Ratings related to player mentality attributes.
- defending\_marking\_awareness, defending\_standing\_tackle, defending\_sliding\_tackle: Ratings related to player defending abilities.
- goalkeeping\_diving, goalkeeping\_handling, goalkeeping\_kicking, goalkeeping\_positioning, goalkeeping\_reflexes, goalkeeping\_speed: Ratings related to player goalkeeping abilities (for goalkeepers only).
- ls, st, rs, lw, lf, cf, rf, rw, lam, cam, ram, lm, lcm, cm, rcm, rm, lwb, ldm, cdm, rdm, rwb, lb, lcb, cb, rcb, rb, gk: Player positions with specific ratings for each position (for outfield players and goalkeepers).
- player\_face\_url: URL link to the player's face image.
- club\_logo\_url: URL link to the club's logo image.
- club\_flag\_url: URL link to the club's flag image.
- nation\_logo\_url: URL link to the national team's logo image.
- nation\_flag\_url: URL link to the national team's flag image.
- year: Mentions the year of the ratings of the player  
- unique\_id: Unique id for each entry in the dataset

********

**Identification of Constraints:**


|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                         |                                |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------- | ------------------------------ |
| Feature Name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Constraint                              | Constraints in SQL             |
| sofifa\_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | number                                  | NOT NULL, NUMERIC              |
| player\_url                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | character                               | NOT NULL, UNIQUE, VARCHAR(255) |
| short\_name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Character                               | NOT NULL, VARCHAR(255)         |
| long\_name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Character                               | NOT NULL, VARCHAR(255)         |
| player\_positions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Character                               | NOT NULL, VARCHAR(255)         |
| overall                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | number, >0 and  <100,                   | NOT NULL, NUMERIC              |
| potential                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | number, >0 and  <100,                   | NOT NULL, NUMERIC              |
| value\_eur                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | number                                  | NUMERIC                        |
| wage\_eur                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | number                                  | NUMERIC                        |
| age                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | number                                  | NOT NULL, NUMERIC              |
| dob                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | date                                    | DATE                           |
| height\_cm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | number                                  | NOT NULL, NUMERIC              |
| weight\_kg                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | number                                  | NOT NULL, NUMERIC              |
| club\_team\_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | number                                  | NOT NULL, NUMERIC              |
| club\_name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | character                               | VARCHAR(255)                   |
| league\_name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | character                               | VARCHAR(255)                   |
| league\_level                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | number                                  | NUMERIC                        |
| club\_position                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | character                               | VARCHAR(5)                     |
| club\_jersey\_number                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | number                                  | NUMERIC                        |
| club\_loaned\_from                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | character                               | VARCHAR(255)                   |
| club\_joined                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | date                                    | DATE                           |
| club\_contract\_valid\_until                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | number                                  | NUMERIC                        |
| nationality\_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | number                                  | NUMERIC                        |
| nationality\_name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | character                               | VARCAHR(255)                   |
| nation\_team\_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | number                                  | NUMERIC                        |
| nation\_position                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | character                               | VARCHAR(5)                     |
| nation\_jersey\_number                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | number                                  | NUMERIC                        |
| preferred\_foot                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | character                               | VARCHAR(5)                     |
| weak\_foot                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Number, >0 <=5                          | NUMERIC                        |
| skill\_moves                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Number, >0 <=5                          | NUMERIC                        |
| international\_reputation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Number, >0 <=5                          | NUMERIC                        |
| work\_rate                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | character                               | VARCHAR(15)                    |
| body\_type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | character                               | VARCHAR(15)                    |
| real\_face                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | character                               | VARCHAR(3)                     |
| release\_clause\_eur                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | number                                  | NUMERIC                        |
| player\_tags                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | character                               | VARCHAR(255)                   |
| player\_traits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | character                               | VARCHAR(255)                   |
| pace, shooting, passing, dribbling, physic, attacking\_crossing, attacking\_finishing, attacking\_heading\_accuracy, attacking\_short\_passing, attacking\_volleys, skill\_dribbling, skill\_curve, skill\_fk\_accuracy, skill\_long\_passing, skill\_ball\_control, movement\_acceleration, movement\_sprint\_speed, movement\_agility, movement\_reactions, movement\_balance, power\_shot\_power, power\_jumping, power\_stamina, power\_strength, power\_long\_shots, mentality\_aggression, mentality\_interceptions, mentality\_positioning, mentality\_vision, mentality\_penalties,mentality\_composure, defending\_marking\_awareness, defending\_standing\_tackle, defending\_sliding\_tackle, goalkeeping\_diving, goalkeeping\_handling, goalkeeping\_kicking, goalkeeping\_positioning, goalkeeping\_reflexes, goalkeeping\_speed | Number, >0 and <100                     | NUMERIC                        |
|  Ls, st, rs, lw, lf, cf, rf, rw, lam, cam, ram, lm, lcm, cm, rcm, rm, lwb, ldm, cdm, rdm, rwb, lb, lcb, cb, rcb, rb, gk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | character(because there is a plus sign) | NOT NULL, VARCHAR(5)           |
| player\_face\_url                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | character                               | NOT NULL, UNIQUE, VARCHAR(255) |
| club\_logo\_url                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | character                               | NOT NULL, VARCHAR(255)         |
| club\_flag\_url                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | character                               | NOT NULL, VARCHAR(255)         |
| nation\_logo\_url                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | character                               | NOT NULL, VARCHAR(255)         |
| nation\_flag\_url                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | character                               | NOT NULL, VARCHAR(255)         |
| year                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | number                                  | NOT NULL, NUMERIC              |
| unique\_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | PRIMARY\_KEY                            | NOT NULL, UNIQUE, PRIMARY KEY  |
